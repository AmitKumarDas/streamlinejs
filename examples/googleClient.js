/*** Generated by streamline 0.1.16 - DO NOT EDIT ***/

var __global = typeof global !== 'undefined' ? global : window;
function __cb(_, fn) { var ctx = __global.__context; return function(err, result) { __global.__context = ctx; if (err) return _(err); try { return fn(null, result); } catch (ex) { return __propagate(_, ex); } } }
function __future(fn, args, i) { var done, err, result; var cb = function(e, r) { done = true; err = e, result = r; }; args = Array.prototype.slice.call(args); args[i] = function(e, r) { cb(e, r); }; fn.apply(this, args); return function(_) { if (done) _.call(this, err, result); else cb = _.bind(this); }.bind(this); }
function __propagate(_, err) { try { _(err); } catch (ex) { __trap(ex); } }
function __trap(err) { if (err) { if (__global.__context && __global.__context.errorHandler) __global.__context.errorHandler(err); else console.error("UNCAUGHT EXCEPTION: " + err.message + "\n" + err.stack); } }
            (function(_) {
              var __then = (_ = (_ || __trap));
/*     8 */   var streams = require("../lib/streams");
/*    10 */   function google(str, _) {
                if (!_) {
                  return __future(google, arguments, 1);
                }
              ;
                var __then = _;
/*    16 */     var req = streams.httpRequest(("http://ajax.googleapis.com/ajax/services/search/web?v=1.0&q=" + str));
/*    22 */     return req.end().response(__cb(_, function(__0, resp) {
/*    24 */       return resp.checkStatus(200).readAll(__cb(_, function(__0, __2) {
/*    24 */         return _(null, JSON.parse(__2));
                  }));
                }));
              };
/*    28 */   var str = ((process.argv.length > 2) ? process.argv[2] : "node.js");
/*    31 */   return google(str, __cb(_, function(__0, result) {
/*    34 */     var formatted = result.responseData.results.map(function __1(entry) {
/*    35 */       return ((entry.url + "\n	") + entry.titleNoFormatting);
/*    36 */     }).join("\n");
/*    37 */     console.log(formatted);
                return __then();
              }));
            })();
