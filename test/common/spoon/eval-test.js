/*** Generated by streamline 0.4.5 (spoon) - DO NOT EDIT ***/var __$rt = require('streamline/lib/spoon/runtime');
(function(__$callback) {
var module;

module = QUnit.module;

module("streamline evaluation");

function evalTest(f, val) {
    f(function(err, result) {
        var __$i159;
        var str;
        if (err) {
            __$i159 = "ERR: " + err;
        } else {
            __$i159 = result;
        };
        str = __$i159;
        strictEqual(str, val);
        start();
    });
};

function delay(__$callback, val) {
    if (!__$callback) {
        return __$rt.future.call(this, delay, arguments, 0);
    }
    function __$fn148(__$e, __$r) {
        if (__$e) {
            return __$callback.call(this, __$e);
        };
        return __$callback.call(this, null, val);
    };
    return setTimeout(__$fn148, 0);
};

function delayFail(__$callback, err) {
    if (!__$callback) {
        return __$rt.future.call(this, delayFail, arguments, 0);
    }
    function __$fn149(__$e, __$r) {
        if (__$e) {
            return __$callback.call(this, __$e);
        };
        throw err;
    };
    return setTimeout(__$fn149, 0);
};

function throwError(message) {
    throw new Error(message);
};

asyncTest("eval return", 1, function __$anon1(__$callback) {
    if (!__$callback) {
        return __$rt.future.call(this, __$anon1, arguments, 0);
    }
    evalTest(function f(__$callback) {
        if (!__$callback) {
            return __$rt.future.call(this, f, arguments, 0);
        }
        function __$fn150(__$e, __$r) {
            if (__$e) {
                return __$callback.call(this, __$e);
            };
            return __$callback.call(this, null, __$r);
        };
        return delay(__$fn150, 5);
    }, 5);
    return __$callback.call(this, null);
});

asyncTest("eval if true", 1, function __$anon2(__$callback) {
    if (!__$callback) {
        return __$rt.future.call(this, __$anon2, arguments, 0);
    }
    evalTest(function f(__$callback) {
        if (!__$callback) {
            return __$rt.future.call(this, f, arguments, 0);
        }
        function __$fn151(__$e, __$r) {
            if (__$e) {
                return __$callback.call(this, __$e);
            };
            return __$callback.call(this, null, __$r);
        };
        if (true) {
            return delay(__$fn151, 3);
        } else {
            return __$callback.call(this, null, 4);
        };
    }, 3);
    return __$callback.call(this, null);
});

asyncTest("eval if false", 1, function __$anon3(__$callback) {
    if (!__$callback) {
        return __$rt.future.call(this, __$anon3, arguments, 0);
    }
    evalTest(function f(__$callback) {
        if (!__$callback) {
            return __$rt.future.call(this, f, arguments, 0);
        }
        function __$fn152(__$e, __$r) {
            if (__$e) {
                return __$callback.call(this, __$e);
            };
            return __$callback.call(this, null, __$r);
        };
        if (false) {
            return delay(__$fn152, 3);
        } else {
            return __$callback.call(this, null, 4);
        };
    }, 4);
    return __$callback.call(this, null);
});

asyncTest("eval while", 1, function __$anon4(__$callback) {
    if (!__$callback) {
        return __$rt.future.call(this, __$anon4, arguments, 0);
    }
    evalTest(function f(__$callback) {
        if (!__$callback) {
            return __$rt.future.call(this, f, arguments, 0);
        }
        function __$fn154(__$e, __$r) {
            if (__$e) {
                return __$callback.call(this, __$e);
            };
            while (true) {
                if (!(i < 5)) {
                    break;
                } else {
                    return delay(__$fn153, i * result);
                };
            };
            return __$callback.call(this, null, result);
        };
        function __$fn153(__$e, __$r) {
            if (__$e) {
                return __$callback.call(this, __$e);
            };
            result = __$r;
            i++;
            return __$fn154.call(this);
        };
        var i, result;
        i = 1;
        result = 1;
        return __$fn154.call(this);
    }, 24);
    return __$callback.call(this, null);
});

asyncTest("try catch 1", 1, function __$anon5(__$callback) {
    if (!__$callback) {
        return __$rt.future.call(this, __$anon5, arguments, 0);
    }
    evalTest(function f(__$callback) {
        if (!__$callback) {
            return __$rt.future.call(this, f, arguments, 0);
        }
        function __$fn156(__$e, __$r) {
            if (__$e) {
                return __$callback.call(this, __$e);
            };
            return __$callback.call(this, null, __$r);
        };
        function __$fn155(__$e, __$r) {
            if (__$e) {
                return __$callback.call(this, __$e);
            };
            return __$callback.call(this, null, __$r);
        };
        try {
            return delay(__$fn155, "ok");
        } catch (ex) {
            return delay(__$fn156, "err");
        };
    }, "ok");
    return __$callback.call(this, null);
});

asyncTest("and ok", 1, function __$anon6(__$callback) {
    if (!__$callback) {
        return __$rt.future.call(this, __$anon6, arguments, 0);
    }
    evalTest(function f(__$callback) {
        if (!__$callback) {
            return __$rt.future.call(this, f, arguments, 0);
        }
        var __$i341;
        var __$i318;
        var __$i295;
        var __$i272;
        var __$i249;
        function __$fn157(__$e, __$r) {
            function __$fn159(__$e, __$r) {
                function __$fn160(__$e, __$r) {
                    function __$fn162(__$e, __$r) {
                        function __$fn163(__$e, __$r) {
                            function __$fn165(__$e, __$r) {
                                function __$fn166(__$e, __$r) {
                                    function __$fn168(__$e, __$r) {
                                        function __$fn169(__$e, __$r) {
                                            function __$fn171(__$e, __$r) {
                                                if (__$e) {
                                                    return __$callback.call(this, __$e);
                                                };
                                                if (__$i341) {
                                                    x += "T5";
                                                } else {
                                                    x += "F5";
                                                };
                                                x += ">>";
                                                return __$callback.call(this, null, x);
                                            };
                                            function __$fn170(__$e, __$r) {
                                                if (__$e) {
                                                    return __$callback.call(this, __$e);
                                                };
                                                __$i341 = __$r;
                                                return __$fn171.call(this);
                                            };
                                            if (__$e) {
                                                return __$callback.call(this, __$e);
                                            };
                                            if (__$r) {
                                                return delayFail(__$fn170, "bad");
                                            } else {
                                                __$i341 = __$r;
                                                return __$fn171.call(this);
                                            };
                                        };
                                        if (__$e) {
                                            return __$callback.call(this, __$e);
                                        };
                                        if (__$i318) {
                                            x += "T4";
                                        } else {
                                            x += "F4";
                                        };
                                        return delay(__$fn169, false);
                                    };
                                    function __$fn167(__$e, __$r) {
                                        if (__$e) {
                                            return __$callback.call(this, __$e);
                                        };
                                        __$i318 = __$r;
                                        return __$fn168.call(this);
                                    };
                                    if (__$e) {
                                        return __$callback.call(this, __$e);
                                    };
                                    if (__$r) {
                                        return delay(__$fn167, false);
                                    } else {
                                        __$i318 = __$r;
                                        return __$fn168.call(this);
                                    };
                                };
                                if (__$e) {
                                    return __$callback.call(this, __$e);
                                };
                                if (__$i295) {
                                    x += "T3";
                                } else {
                                    x += "F3";
                                };
                                return delay(__$fn166, false);
                            };
                            function __$fn164(__$e, __$r) {
                                if (__$e) {
                                    return __$callback.call(this, __$e);
                                };
                                __$i295 = __$r;
                                return __$fn165.call(this);
                            };
                            if (__$e) {
                                return __$callback.call(this, __$e);
                            };
                            if (__$r) {
                                return delay(__$fn164, true);
                            } else {
                                __$i295 = __$r;
                                return __$fn165.call(this);
                            };
                        };
                        if (__$e) {
                            return __$callback.call(this, __$e);
                        };
                        if (__$i272) {
                            x += "T2";
                        } else {
                            x += "F2";
                        };
                        return delay(__$fn163, false);
                    };
                    function __$fn161(__$e, __$r) {
                        if (__$e) {
                            return __$callback.call(this, __$e);
                        };
                        __$i272 = __$r;
                        return __$fn162.call(this);
                    };
                    if (__$e) {
                        return __$callback.call(this, __$e);
                    };
                    if (__$r) {
                        return delay(__$fn161, false);
                    } else {
                        __$i272 = __$r;
                        return __$fn162.call(this);
                    };
                };
                if (__$e) {
                    return __$callback.call(this, __$e);
                };
                if (__$i249) {
                    x += "T1";
                } else {
                    x += "F1";
                };
                return delay(__$fn160, true);
            };
            function __$fn158(__$e, __$r) {
                if (__$e) {
                    return __$callback.call(this, __$e);
                };
                __$i249 = __$r;
                return __$fn159.call(this);
            };
            if (__$e) {
                return __$callback.call(this, __$e);
            };
            if (__$r) {
                return delay(__$fn158, true);
            } else {
                __$i249 = __$r;
                return __$fn159.call(this);
            };
        };
        var x;
        x = "<<";
        return delay(__$fn157, true);
    }, "<<T1F2F3F4F5>>");
    return __$callback.call(this, null);
});

asyncTest("or ok", 1, function __$anon7(__$callback) {
    if (!__$callback) {
        return __$rt.future.call(this, __$anon7, arguments, 0);
    }
    evalTest(function f(__$callback) {
        if (!__$callback) {
            return __$rt.future.call(this, f, arguments, 0);
        }
        var __$i463;
        var __$i440;
        var __$i417;
        var __$i394;
        var __$i371;
        function __$fn172(__$e, __$r) {
            function __$fn174(__$e, __$r) {
                function __$fn175(__$e, __$r) {
                    function __$fn177(__$e, __$r) {
                        function __$fn178(__$e, __$r) {
                            function __$fn180(__$e, __$r) {
                                function __$fn181(__$e, __$r) {
                                    function __$fn183(__$e, __$r) {
                                        function __$fn184(__$e, __$r) {
                                            function __$fn186(__$e, __$r) {
                                                if (__$e) {
                                                    return __$callback.call(this, __$e);
                                                };
                                                if (__$i463) {
                                                    x += "T5";
                                                } else {
                                                    x += "F5";
                                                };
                                                x += ">>";
                                                return __$callback.call(this, null, x);
                                            };
                                            function __$fn185(__$e, __$r) {
                                                if (__$e) {
                                                    return __$callback.call(this, __$e);
                                                };
                                                __$i463 = __$r;
                                                return __$fn186.call(this);
                                            };
                                            if (__$e) {
                                                return __$callback.call(this, __$e);
                                            };
                                            if (__$r) {
                                                __$i463 = __$r;
                                                return __$fn186.call(this);
                                            } else {
                                                return delayFail(__$fn185, "bad");
                                            };
                                        };
                                        if (__$e) {
                                            return __$callback.call(this, __$e);
                                        };
                                        if (__$i440) {
                                            x += "T4";
                                        } else {
                                            x += "F4";
                                        };
                                        return delay(__$fn184, true);
                                    };
                                    function __$fn182(__$e, __$r) {
                                        if (__$e) {
                                            return __$callback.call(this, __$e);
                                        };
                                        __$i440 = __$r;
                                        return __$fn183.call(this);
                                    };
                                    if (__$e) {
                                        return __$callback.call(this, __$e);
                                    };
                                    if (__$r) {
                                        __$i440 = __$r;
                                        return __$fn183.call(this);
                                    } else {
                                        return delay(__$fn182, false);
                                    };
                                };
                                if (__$e) {
                                    return __$callback.call(this, __$e);
                                };
                                if (__$i417) {
                                    x += "T3";
                                } else {
                                    x += "F3";
                                };
                                return delay(__$fn181, false);
                            };
                            function __$fn179(__$e, __$r) {
                                if (__$e) {
                                    return __$callback.call(this, __$e);
                                };
                                __$i417 = __$r;
                                return __$fn180.call(this);
                            };
                            if (__$e) {
                                return __$callback.call(this, __$e);
                            };
                            if (__$r) {
                                __$i417 = __$r;
                                return __$fn180.call(this);
                            } else {
                                return delay(__$fn179, true);
                            };
                        };
                        if (__$e) {
                            return __$callback.call(this, __$e);
                        };
                        if (__$i394) {
                            x += "T2";
                        } else {
                            x += "F2";
                        };
                        return delay(__$fn178, false);
                    };
                    function __$fn176(__$e, __$r) {
                        if (__$e) {
                            return __$callback.call(this, __$e);
                        };
                        __$i394 = __$r;
                        return __$fn177.call(this);
                    };
                    if (__$e) {
                        return __$callback.call(this, __$e);
                    };
                    if (__$r) {
                        __$i394 = __$r;
                        return __$fn177.call(this);
                    } else {
                        return delay(__$fn176, false);
                    };
                };
                if (__$e) {
                    return __$callback.call(this, __$e);
                };
                if (__$i371) {
                    x += "T1";
                } else {
                    x += "F1";
                };
                return delay(__$fn175, true);
            };
            function __$fn173(__$e, __$r) {
                if (__$e) {
                    return __$callback.call(this, __$e);
                };
                __$i371 = __$r;
                return __$fn174.call(this);
            };
            if (__$e) {
                return __$callback.call(this, __$e);
            };
            if (__$r) {
                __$i371 = __$r;
                return __$fn174.call(this);
            } else {
                return delay(__$fn173, true);
            };
        };
        var x;
        x = "<<";
        return delay(__$fn172, true);
    }, "<<T1T2T3F4T5>>");
    return __$callback.call(this, null);
});

asyncTest("scoping", 1, function __$anon8(__$callback) {
    if (!__$callback) {
        return __$rt.future.call(this, __$anon8, arguments, 0);
    }
    evalTest(function f(__$callback) {
        if (!__$callback) {
            return __$rt.future.call(this, f, arguments, 0);
        }
        function __$fn187(__$e, __$r) {
            if (__$e) {
                return __$callback.call(this, __$e);
            };
            return __$callback.call(this, null, __$r());
        };
        function test(__$callback) {
            if (!__$callback) {
                return __$rt.future.call(this, test, arguments, 0);
            }
            function __$fn191(__$e, __$r) {
                if (__$e) {
                    return __$callback.call(this, __$e);
                };
                foo = "xyz";
                return __$callback.call(this, null, bar);
            };
            var foo;
            var foo;
            foo = "abc";
            function bar() {
                return foo;
            };
            return delay(__$fn191);
        };
        return test(__$fn187);
    }, "xyz");
    return __$callback.call(this, null);
});

asyncTest("return undefined", 1, function __$anon9(__$callback) {
    if (!__$callback) {
        return __$rt.future.call(this, __$anon9, arguments, 0);
    }
    evalTest(function f(__$callback) {
        if (!__$callback) {
            return __$rt.future.call(this, f, arguments, 0);
        }
        function __$fn188(__$e, __$r) {
            if (__$e) {
                return __$callback.call(this, __$e);
            };
            return __$callback.call(this, null, __$r);
        };
        function test(__$callback) {
            if (!__$callback) {
                return __$rt.future.call(this, test, arguments, 0);
            }
            function __$fn192(__$e, __$r) {
                if (__$e) {
                    return __$callback.call(this, __$e);
                };
                return __$callback.call(this, null);
            };
            return delay(__$fn192);
        };
        return test(__$fn188);
    }, undefined);
    return __$callback.call(this, null);
});

asyncTest("coffeescript wrapper 1", 1, function __$anon10(__$callback) {
    if (!__$callback) {
        return __$rt.future.call(this, __$anon10, arguments, 0);
    }
    evalTest(function f(__$callback) {
        if (!__$callback) {
            return __$rt.future.call(this, f, arguments, 0);
        }
        function __$fn189(__$e, __$r) {
            if (__$e) {
                return __$callback.call(this, __$e);
            };
            return __$callback.call(this, null, __$r);
        };
        return function __$anon11(__$callback) {
            if (!__$callback) {
                return __$rt.future.call(this, __$anon11, arguments, 0);
            }
            function __$fn193(__$e, __$r) {
                if (__$e) {
                    return __$callback.call(this, __$e);
                };
                return __$callback.call(this, null, __$r);
            };
            return delay(__$fn193, "cs1");
        }(__$fn189);
    }, "cs1");
    return __$callback.call(this, null);
});

asyncTest("coffeescript wrapper 2", 1, function __$anon12(__$callback) {
    if (!__$callback) {
        return __$rt.future.call(this, __$anon12, arguments, 0);
    }
    evalTest(function f(__$callback) {
        if (!__$callback) {
            return __$rt.future.call(this, f, arguments, 0);
        }
        function __$fn190(__$e, __$r) {
            if (__$e) {
                return __$callback.call(this, __$e);
            };
            return __$callback.call(this, null, __$r);
        };
        return function __$anon13(__$callback) {
            if (!__$callback) {
                return __$rt.future.call(this, __$anon13, arguments, 0);
            }
            function __$fn194(__$e, __$r) {
                if (__$e) {
                    return __$callback.call(this, __$e);
                };
                return __$callback.call(this, null, __$r);
            };
            return delay(__$fn194, "cs2");
        }.call(this, __$fn190);
    }, "cs2");
    return __$callback.call(this, null);
});

asyncTest("sync try/catch in async", 1, function __$anon14(__$callback) {
    if (!__$callback) {
        return __$rt.future.call(this, __$anon14, arguments, 0);
    }
    evalTest(function f(__$callback) {
        if (!__$callback) {
            return __$rt.future.call(this, f, arguments, 0);
        }
        try {
            throw new Error("catch me");
        } catch (ex) {
            return __$callback.call(this, null, "got it");
        };
    }, "got it");
    return __$callback.call(this, null);
});

asyncTest("sync try/catch inside conditional", 1, function __$anon15(__$callback) {
    if (!__$callback) {
        return __$rt.future.call(this, __$anon15, arguments, 0);
    }
    evalTest(function f(__$callback) {
        if (!__$callback) {
            return __$rt.future.call(this, f, arguments, 0);
        }
        if (true) {
            try {} catch (ex) {};
        } else {};
        return __$callback.call(this, null);
    }, undefined);
    return __$callback.call(this, null);
});

return __$callback.call(this, null);
})(function(__$e) { if (__$e) console.log(__$e); });