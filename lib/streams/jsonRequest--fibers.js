/*** Generated by streamline fibers 0.1.0 - DO NOT EDIT ***/var fstreamline__ = require("streamline/lib/fibers/runtime"); (fstreamline__.create(function(_) { /**
 * Copyright (c) 2011 Bruno Jouhier <bruno.jouhier@sage.com>
 * MIT License
 */
"use strict";
//streamline.options = { "lines" : "preserve" }

var streams = require("./streams");
/// !nodoc -- experimental
/// 
/// # streamline/lib/streams/jsonRequest
///  
/// Simple json request wrapper
exports.send = fstreamline__.create(function(_, url, obj) {
	var json = obj && typeof obj !== "string" ? JSON.stringify(obj) : obj;
	var result = fstreamline__.invoke(fstreamline__.invoke(streams.httpRequest({
		url: url,
		method: json ? "POST" : "GET",
		headers: { "content-type" : "application/json"}
	}).end(json, "utf8"), "response", [_], 0), "readAll", [_], 0);
	return JSON.parse(result);
}, 0)

}, 0).call(this, function(err) {
  if (err) throw err;
}));